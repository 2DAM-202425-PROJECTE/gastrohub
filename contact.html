<!DOCTYPE html>
<html lang="en" class="min-h-screen">
<head>
    <meta charset="UTF-8"/>
    <link rel="icon" type="image/svg+xml" href="/assets/logo.png"/>
    <link rel="stylesheet" href="/css/contact.css"/>
    <link href="style.css" rel="stylesheet"/>
    <link rel="stylesheet" href="/css/global.css"/>
    <script type="module" src="/javascript/header-footer-loader.js"></script>
    <link href="./css/login.css" rel="stylesheet"/>
    <link rel="stylesheet" href="/css/header-footer.css"/>
    <script type="module" src="/javascript/header.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="/javascript/index-controller.js"></script>
    <title>GastroHub | Contact Us</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>
</head>
<body class="min-h-screen bg-white dark:bg-black">
<header id="navbar"></header>
<section class="min-h-screen pt-36">
    <div class="absolute inset-x-0 -top-3 -z-10 transform-gpu overflow-hidden px-36 blur-3xl" aria-hidden="true">
        <div class=" aspect-[1155/678] w-[72.1875rem] bg-gradient-to-tr from-[#EEEEEE] to-[#76ABAE] opacity-30"
             style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)">
        </div>
    </div>
    <div class="py-8 lg:py-16 px-4 mx-auto max-w-screen-md ">
        <h2 id="titol" class="mb-4 text-4xl tracking-tight font-extrabold text-center text-gray-900 dark:text-white">Contact Us</h2>
        <p id="phrase" class="mb-8 lg:mb-16 font-light text-center text-gray-500 dark:text-gray-400 sm:text-xl">Got a technical issue? Want to send feedback about a beta feature? Need details about our Business plan? Let us know.</p>
        <form id="contact-form" class="space-y-8">
            <div>
                <label for="email" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Your email</label>
                <input type="email" id="email" class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light" placeholder="name@gmail.com" required>
            </div>
            <div>
                <label for="subject" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Subject</label>
                <input type="text" id="subject" class="block p-3 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 shadow-sm focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light" placeholder="Let us know how we can help you" required>
            </div>
            <div class="mb-4 relative">
                <label for="country-code" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Country Code</label>
                <div class="flex items-center">
                    <input type="text" id="country-code" class="block p-3 ml-0 w-1/5 mr-5 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 shadow-sm focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light" placeholder="Select country code" readonly required />
                    <input type="tel" id="phone" pattern="\d{9}" class="block p-3 w-[calc(80%-1.25rem)] text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 shadow-sm focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light" placeholder="Enter your phone number" required>
                </div>
                <div class="relative z-10 hidden bg-pteal border border-gray-300 rounded-lg shadow-lg mt-1 max-h-40 overflow-y-auto" id="country-dropdown" style="margin-top: 10px;">

                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+1" onclick="selectCountry('+1 (USA)')">ðŸ‡ºðŸ‡¸ +1 (US)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+1" onclick="selectCountry('+1 (Canada)')">ðŸ‡¨ðŸ‡¦ +1 (CA)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+7" onclick="selectCountry('+7 (Russia)')">ðŸ‡·ðŸ‡º +7 (RU)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+33" onclick="selectCountry('+33 (France)')">ðŸ‡«ðŸ‡· +33 (FR)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+34" onclick="selectCountry('+34 (Spain)')">ðŸ‡ªðŸ‡¸ +34 (ES)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+39" onclick="selectCountry('+39 (Italy)')">ðŸ‡®ðŸ‡¹ +39 (IT)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+44" onclick="selectCountry('+44 (UK)')">ðŸ‡¬ðŸ‡§ +44 (GB)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+45" onclick="selectCountry('+45 (Denmark)')">ðŸ‡©ðŸ‡° +45 (DK)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+46" onclick="selectCountry('+46 (Sweden)')">ðŸ‡¸ðŸ‡ª +46 (SE)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+47" onclick="selectCountry('+47 (Norway)')">ðŸ‡³ðŸ‡´ +47 (NO)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+49" onclick="selectCountry('+49 (Germany)')">ðŸ‡©ðŸ‡ª +49 (DE)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+52" onclick="selectCountry('+52 (Mexico)')">ðŸ‡²ðŸ‡½ +52 (MX)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+54" onclick="selectCountry('+54 (Argentina)')">ðŸ‡¦ðŸ‡· +54 (AR)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+55" onclick="selectCountry('+55 (Brazil)')">ðŸ‡§ðŸ‡· +55 (BR)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+56" onclick="selectCountry('+56 (Chile)')">ðŸ‡¨ðŸ‡± +56 (CL)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+57" onclick="selectCountry('+57 (Colombia)')">ðŸ‡¨ðŸ‡´ +57 (CO)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+61" onclick="selectCountry('+61 (Australia)')">ðŸ‡¦ðŸ‡º +61 (AU)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+64" onclick="selectCountry('+64 (New Zealand)')">ðŸ‡³ðŸ‡¿ +64 (NZ)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+65" onclick="selectCountry('+65 (Singapore)')">ðŸ‡¸ðŸ‡¬ +65 (SG)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+81" onclick="selectCountry('+81 (Japan)')">ðŸ‡¯ðŸ‡µ +81 (JP)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+86" onclick="selectCountry('+86 (China)')">ðŸ‡¨ðŸ‡³ +86 (CN)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+91" onclick="selectCountry('+91 (India)')">ðŸ‡®ðŸ‡³ +91 (IN)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+506" onclick="selectCountry('+506 (Costa Rica)')">ðŸ‡¨ðŸ‡· +506 (CR)</div>
                    <div class="cursor-pointer p-2 hover:bg-pteal-light" data-value="+598" onclick="selectCountry('+598 (Uruguay)')">ðŸ‡ºðŸ‡¾ +598 (UY)</div>
                </div>
            </div>
            <div class="sm:col-span-2">
                <label for="message" class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Your message</label>
                <textarea id="message" rows="6" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg shadow-sm border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Leave a comment..." required></textarea>
            </div>
            <div class="mt-4">
                <button type="button" id="upload_widget" class="hidden bg-pteal hover:bg-pteal-dark py-3 px-5 text-sm font-medium text-center text-white rounded-lg sm:w-fit hover:bg-primary-800 focus:ring-4 focus:outline-none focus:ring-primary-300 dark:focus:ring-primary-800 transform transition duration-300 hover:scale-105">Upload Files</button>            </div>
            <div id="file-preview" class="mt-4"></div>
            <div class="mt-4">
                <button type="submit" class="bg-pteal hover:bg-pteal-dark py-3 px-5 text-sm font-medium text-center text-white rounded-lg sm:w-fit hover:bg-primary-800 focus:ring-4 focus:outline-none focus:ring-primary-300 dark:focus:ring-primary-800 transform transition duration-300 hover:scale-105">Send message</button>            </div>
        </form>
        <div id="form-messages" class="mt-4"></div>
    </div>
</section>
<footer id="footer"></footer>

<script type="module">
    // Inicializa EmailJS
    (function () {
        emailjs.init('_W3Zv2n0xStmfdhOQ'); // Reemplaza con tu ID de usuario de EmailJS
    })();

    document.getElementById('contact-form').addEventListener('submit', function(event) {
        const phoneInput = document.getElementById('phone');
        if (!phoneInput.checkValidity()) {
            event.preventDefault();
            document.getElementById('form-messages').innerHTML = '<p class="text-red-500">El nÃºmero de telÃ©fono debe tener exactamente 9 dÃ­gitos.</p>';
            return;
        }
    });

    // Inicializa un array para almacenar las URLs de los archivos
    let fileUrls = [];

    // Configura el widget de Cloudinary
    const myWidget = cloudinary.createUploadWidget({
        cloudName: 'dvqlqvleg', // Reemplaza con tu Cloud Name
        uploadPreset: 'GastroHub', // Reemplaza con tu Upload Preset
    }, (error, result) => {
        if (!error && result && result.event === "success") {
            const fileUrl = result.info.secure_url;
            console.log('File URL:', fileUrl);
            // AÃ±ade la URL al array de URLs de archivos
            fileUrls.push(fileUrl);
            // Habilita el botÃ³n de envÃ­o
            document.querySelector('button[type="submit"]').disabled = false;

            // Muestra la vista previa del archivo en forma de barra
            const previewContainer = document.getElementById('file-preview');
            const fileElement = document.createElement('div');
            fileElement.className = 'file-item';
            fileElement.innerHTML = `<span>${result.info.original_filename}</span> <a href="${fileUrl}" target="_blank">View</a>`;
            previewContainer.appendChild(fileElement);
        }
    });

    // Configura el botÃ³n para abrir el widget
    document.getElementById("upload_widget").onclick = function () {
        myWidget.open();
        // Deshabilita el botÃ³n de envÃ­o hasta que el archivo se haya subido
        document.querySelector('button[type="submit"]').disabled = true;
    };

    // Maneja el envÃ­o del formulario
    document.getElementById('contact-form').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevenir el envÃ­o normal del formulario

        const emailContent = {
            email: document.getElementById('email').value,
            subject: document.getElementById('subject').value,
            message: document.getElementById('message').value,
            phone: document.getElementById('phone').value, // Agrega telÃ©fono
            regionPrefix: document.getElementById('country-code').value,
            fileUrls: fileUrls.join(', ') // Concatena las URLs en una sola cadena
        };

        // EnvÃ­a el correo electrÃ³nico
        emailjs.send('service_uu8xekq', 'template_hcvyu63', emailContent)
            .then(function (response) {
                document.getElementById('form-messages').innerHTML = '<p class="text-green-500">Â¡Correo enviado exitosamente!</p>';
                console.log('SUCCESS!', response.status, response.text);
                document.getElementById('contact-form').reset(); // Limpiar campos del formulario
                document.getElementById('file-preview').innerHTML = ''; // Limpiar la vista previa de archivos
                fileUrls = []; // Limpiar el array de URLs de archivos
            }, function (error) {
                document.getElementById('form-messages').innerHTML = '<p class="text-red-500">No se pudo enviar el mensaje. Intenta de nuevo.</p>';
                console.log('FAILED...', error);
            });
    });

    // Funciones para seleccionar paÃ­s y actualizar el campo de cÃ³digo de paÃ­s
    window.selectCountry = function (countryCode) {
        document.getElementById('country-code').value = countryCode;
        document.getElementById('country-dropdown').classList.add('hidden');
    }

    // Mostrar dropdown al hacer clic en el campo del cÃ³digo de paÃ­s
    document.getElementById('country-code').addEventListener('click', function() {
        const dropdown = document.getElementById('country-dropdown');
        dropdown.classList.toggle('hidden');
        if (!dropdown.classList.contains('hidden')) {
            dropdown.scrollTop = 0; // Desplazar al inicio
        }
    });

    // Ocultar dropdown al hacer clic fuera de Ã©l
    document.addEventListener('click', function(event) {
        const dropdown = document.getElementById('country-dropdown');
        if (!dropdown.contains(event.target) && event.target.id !== 'country-code') {
            dropdown.classList.add('hidden');
        }
    });

    function updatePlaceholder() {
        const countryCodeInput = document.getElementById('country-code');
        if (window.innerWidth <= 1000) {
            countryCodeInput.placeholder = 'Country';
        } else {
            countryCodeInput.placeholder = 'Select country code';
        }
    }

    // Llama a la funciÃ³n al cargar la pÃ¡gina y al redimensionar la ventana
    document.addEventListener('DOMContentLoaded', updatePlaceholder);
    window.addEventListener('resize', updatePlaceholder);
</script>
</body>
</html>